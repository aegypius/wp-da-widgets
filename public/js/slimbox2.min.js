(function(a){function C(){var b=l.scrollLeft(),d=l.width();a([e,p]).css("left",b+d/2);D&&a(i).css({left:b,top:l.scrollTop(),width:d,height:l.height()})}function E(b){if(b)a("object").add(F?"select":"embed").each(function(d,f){y[d]=[f,f.style.visibility];f.style.visibility="hidden"});else{a.each(y,function(d,f){f[0].style.visibility=f[1]});y=[]}b=b?"bind":"unbind";l[b]("scroll resize",C);a(document)[b]("keydown",R)}function R(b){b=b.keyCode;var d=a.inArray;return d(b,c.closeKeys)>=0?G():d(b,c.nextKeys)>=
0?H():d(b,c.previousKeys)>=0?I():false}function I(){return z(q)}function H(){return z(r)}function z(b){if(b>=0){j=b;u=g[j][0];q=(j||(c.loop?g.length:0))-1;r=(j+1)%g.length||(c.loop?0:-1);J();e.className="lbLoading";m=new Image;m.onload=S;m.src=u}return false}function S(){e.className="";a(n).css({backgroundImage:"url("+u+")",visibility:"hidden",display:""});a(A).width(m.width);a([A,v,w]).height(m.height);a(K).html(g[j][1]||"");a(L).html((g.length>1&&c.counterText||"").replace(/{x}/,j+1).replace(/{y}/,
g.length));if(q>=0)M.src=g[q][0];if(r>=0)N.src=g[r][0];h=n.offsetWidth;k=n.offsetHeight;var b=Math.max(0,B-k/2);e.offsetHeight!=k&&a(e).animate({height:k,top:b},c.resizeDuration,c.resizeEasing);e.offsetWidth!=h&&a(e).animate({width:h,marginLeft:-h/2},c.resizeDuration,c.resizeEasing);a(e).queue(function(){a(p).css({width:h,top:b+k,marginLeft:-h/2,visibility:"hidden",display:""});a(n).css({display:"none",visibility:"",opacity:""}).fadeIn(c.imageFadeDuration,T)})}function T(){q>=0&&a(v).show();r>=0&&
a(w).show();a(x).css("marginTop",-x.offsetHeight).animate({marginTop:0},c.captionAnimationDuration);p.style.visibility=""}function J(){m.onload=null;m.src=M.src=N.src=u;a([e,n,x]).stop(true);a([v,w,n,p]).hide()}function G(){if(j>=0){J();j=q=r=-1;a(e).hide();a(i).stop().fadeOut(c.overlayFadeDuration,E)}return false}var l=a(window),c,g,j=-1,u,q,r,D,B,h,k,F=!window.XMLHttpRequest,y=[],m={},M=new Image,N=new Image,i,e,n,A,v,w,p,x,K,L;a(function(){a("body").append(a([i=a('<div id="lbOverlay" />')[0],e=
a('<div id="lbCenter" />')[0],p=a('<div id="lbBottomContainer" />')[0]]).css("display","none"));n=a('<div id="lbImage" />').appendTo(e).append(A=a('<div style="position: relative;" />').append([v=a('<a id="lbPrevLink" href="#" />').click(I)[0],w=a('<a id="lbNextLink" href="#" />').click(H)[0]])[0])[0];x=a('<div id="lbBottom" />').appendTo(p).append([a('<a id="lbCloseLink" href="#" />').add(i).click(G)[0],K=a('<div id="lbCaption" />')[0],L=a('<div id="lbNumber" />')[0],a('<div style="clear: both;" />')[0]])[0]});
a.slimbox=function(b,d,f){c=a.extend({loop:false,overlayOpacity:0.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},f);if(typeof b=="string"){b=[[b,d]];d=0}B=l.scrollTop()+l.height()/2;h=c.initialWidth;k=c.initialHeight;a(e).css({top:Math.max(0,B-k/2),width:h,height:k,marginLeft:-h/2}).show();if(D=F||i.currentStyle&&
i.currentStyle.position!="fixed")i.style.position="absolute";a(i).css("opacity",c.overlayOpacity).fadeIn(c.overlayFadeDuration);C();E(1);g=b;c.loop=c.loop&&g.length>1;return z(d)};a.fn.slimbox=function(b,d,f){d=d||function(t){return[t.href,t.title]};f=f||function(){return true};var O=this;return O.unbind("click").click(function(){var t=this,P=0,s,o=0,Q;s=a.grep(O,function(U,V){return f.call(t,U,V)});for(Q=s.length;o<Q;++o){if(s[o]==t)P=o;s[o]=d(s[o],o)}return a.slimbox(s,P,b)})}})(jQuery);

